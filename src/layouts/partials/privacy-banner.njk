<!-- Privacy Consent Banner for RUM -->
<div id="privacy-banner" class="fixed bottom-0 left-0 right-0 bg-slate-900 text-white p-4 z-50 transform translate-y-full transition-transform duration-300" style="display: none;">
  <div class="container mx-auto flex items-center justify-between gap-4">
    <div class="flex-1">
      <p class="text-sm">
        <span data-i18n-key="privacy.banner.text">{{ 'privacy.banner.text' | t(site.defaultLanguage) or 'We use analytics to improve your experience. Your data is processed anonymously.' }}</span>
      </p>
    </div>
    <div class="flex gap-2">
      <button 
        id="privacy-accept" 
        class="bg-sky-600 hover:bg-sky-700 text-white px-4 py-2 rounded text-sm font-medium transition-colors"
        data-i18n-key="privacy.banner.accept"
      >
        {{ 'privacy.banner.accept' | t(site.defaultLanguage) or 'Accept' }}
      </button>
      <button 
        id="privacy-decline" 
        class="bg-slate-600 hover:bg-slate-700 text-white px-4 py-2 rounded text-sm font-medium transition-colors"
        data-i18n-key="privacy.banner.decline"
      >
        {{ 'privacy.banner.decline' | t(site.defaultLanguage) or 'Decline' }}
      </button>
    </div>
  </div>
</div>

<script>
  (function() {
    const banner = document.getElementById('privacy-banner');
    const acceptBtn = document.getElementById('privacy-accept');
    const declineBtn = document.getElementById('privacy-decline');
    
    // Check if consent has already been given
    const consentGiven = localStorage.getItem('rum_consent_given');
    
    if (!consentGiven) {
      // Show banner
      banner.style.display = 'block';
      setTimeout(() => {
        banner.classList.remove('translate-y-full');
      }, 100);
    }
    
    acceptBtn.addEventListener('click', function() {
      localStorage.setItem('rum_consent_given', 'true');
      banner.classList.add('translate-y-full');
      setTimeout(() => {
        banner.style.display = 'none';
      }, 300);
      
      // Initialize RUM after consent
      if (window.initializeRum) {
        window.initializeRum();
        // Record consent event
        if (window.recordRumEvent) {
          window.recordRumEvent('privacy_consent_given', { action: 'accept' });
        }
      }
    });
    
    declineBtn.addEventListener('click', function() {
      localStorage.setItem('rum_consent_given', 'false');
      banner.classList.add('translate-y-full');
      setTimeout(() => {
        banner.style.display = 'none';
      }, 300);
    });
  })();
</script>
