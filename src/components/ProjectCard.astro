---
// Project Card component for Astro
export interface Props {
  project: {
    url: string;
    fileSlug: string;
    data?: {
      title: string;
      description?: string;
      heroImage?: string;
      alt?: string;
      tags?: string[];
    };
  };
}

const { project } = Astro.props;
const data = project.data || {};
const title = data.title || 'Untitled Project';
const description = data.description || '';
const heroImage = data.heroImage;
const alt = data.alt || data.title || 'Project image';
const tags = data.tags || [];

// Truncate description function
function truncateText(text: string, maxLength: number = 120): string {
  if (text.length <= maxLength) return text;
  return text.substring(0, maxLength).trim() + 'â€¦';
}
---

<article 
  class="relative rounded-xl border border-slate-200 bg-white p-4 shadow-sm transition hover:shadow-md focus-within:shadow-md hover:-translate-y-0.5 focus-within:-translate-y-0.5 duration-200" 
  role="listitem" 
  aria-labelledby={`proj-${project.fileSlug}`}
>
  <a 
    href={project.url} 
    class="absolute inset-0 rounded-xl focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-500 focus-visible:ring-offset-2 focus-visible:ring-offset-white" 
    aria-label={`View project: ${title}`}
  >
    <span class="sr-only">{title}</span>
  </a>
  
  {heroImage && (
    <div class="mb-3 overflow-hidden rounded-lg">
      <img 
        src={heroImage} 
        alt={alt}
        class="h-40 w-full object-cover transition-transform duration-200 group-hover:scale-[1.02]"
        loading="lazy"
        decoding="async"
      />
    </div>
  )}
  
  <h3 id={`proj-${project.fileSlug}`} class="mb-1 text-lg font-semibold text-slate-900">
    {title}
  </h3>
  
  {description && (
    <p class="mb-3 text-sm text-slate-600">
      {truncateText(description)}
    </p>
  )}
  
  {tags.length > 0 && (
    <ul class="flex flex-wrap gap-2" aria-label="Technologies used">
      {tags.slice(0, 5).map((tag: any) => (
        <li>
          <span class="inline-block rounded bg-slate-100 px-2 py-1 text-xs font-medium text-slate-700">
            {tag}
          </span>
        </li>
      ))}
    </ul>
  )}
</article>
